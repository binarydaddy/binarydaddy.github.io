<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Review - [Paper Title]</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Add Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Add highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/github.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
    <!-- Add MathJax for rendering LaTeX equations -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="index.html">Your Name</a>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#projects">Projects</a></li>
                    <li><a href="index.html#papers">Paper Reviews</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
                <div class="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <main class="paper-review">
        <div class="container">
            <article class="review-content">
                <!-- Paper Header -->
                <header class="paper-header">
                    <h1 id="paper-title">Paper Title</h1>
                    <div class="paper-meta">
                        <p class="authors" id="paper-authors">Authors: Author 1, Author 2, et al.</p>
                        <p class="conference" id="paper-conference">Conference/Journal: Conference Name Year</p>
                        <div class="paper-links">
                            <a href="#" class="btn small" target="_blank" id="paper-pdf">
                                <i class="fas fa-file-pdf"></i> PDF
                            </a>
                            <a href="#" class="btn small" target="_blank" id="paper-code">
                                <i class="fas fa-code"></i> Code
                            </a>
                        </div>
                    </div>
                </header>

                <!-- Content will be loaded from Markdown -->
                <div id="markdown-content">
                    <div class="loading">
                        <p>Loading paper review...</p>
                    </div>
                </div>
            </article>

            <!-- Sidebar -->
            <aside class="review-sidebar">
                <div class="paper-info-card">
                    <h3>Paper Information</h3>
                    <ul id="paper-metadata">
                        <li><strong>Category:</strong> <span id="paper-category">[Category]</span></li>
                        <li><strong>Year:</strong> <span id="paper-year">[Year]</span></li>
                        <li><strong>Venue:</strong> <span id="paper-venue">[Venue]</span></li>
                        <li><strong>Citations:</strong> <span id="paper-citations">[Number]</span></li>
                    </ul>
                </div>

                <div class="related-papers">
                    <h3>Related Papers</h3>
                    <ul id="related-papers-list">
                        <li><a href="#">Related Paper 1</a></li>
                        <li><a href="#">Related Paper 2</a></li>
                        <li><a href="#">Related Paper 3</a></li>
                    </ul>
                </div>
            </aside>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Â© <span id="year">2024</span> Your Name. All rights reserved.</p>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Get the paper ID from the URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const paperId = urlParams.get('id') || 'example-paper'; // Default to example-paper if no ID provided
            
            try {
                // Load paper metadata and content
                const metadataResponse = await fetch(`papers/${paperId}/metadata.json`);
                
                if (!metadataResponse.ok) {
                    throw new Error('Failed to load paper metadata');
                }
                
                const metadata = await metadataResponse.json();
                
                // Update page title
                document.title = `Paper Review - ${metadata.title}`;
                
                // Update header information
                document.getElementById('paper-title').textContent = metadata.title;
                document.getElementById('paper-authors').textContent = `Authors: ${metadata.authors}`;
                document.getElementById('paper-conference').textContent = `Conference/Journal: ${metadata.venue} ${metadata.year}`;
                
                // Update links
                if (metadata.pdfUrl) {
                    document.getElementById('paper-pdf').href = metadata.pdfUrl;
                }
                
                if (metadata.codeUrl) {
                    document.getElementById('paper-code').href = metadata.codeUrl;
                } else {
                    document.getElementById('paper-code').style.display = 'none';
                }
                
                // Update sidebar metadata
                document.getElementById('paper-category').textContent = metadata.category;
                document.getElementById('paper-year').textContent = metadata.year;
                document.getElementById('paper-venue').textContent = metadata.venue;
                document.getElementById('paper-citations').textContent = metadata.citations || 'N/A';
                
                // Update related papers
                const relatedPapersList = document.getElementById('related-papers-list');
                relatedPapersList.innerHTML = '';
                
                if (metadata.relatedPapers && metadata.relatedPapers.length > 0) {
                    metadata.relatedPapers.forEach(paper => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = `paper-review-template.html?id=${paper.id}`;
                        a.textContent = paper.title;
                        li.appendChild(a);
                        relatedPapersList.appendChild(li);
                    });
                } else {
                    relatedPapersList.innerHTML = '<li>No related papers</li>';
                }
                
                // Load and render the Markdown content
                const contentResponse = await fetch(`papers/${paperId}/review.md`);
                
                if (!contentResponse.ok) {
                    throw new Error('Failed to load paper content');
                }
                
                const markdownContent = await contentResponse.text();
                
                // Configure marked.js options
                marked.setOptions({
                    highlight: function(code, lang) {
                        if (lang && hljs.getLanguage(lang)) {
                            return hljs.highlight(code, { language: lang }).value;
                        }
                        return hljs.highlightAuto(code).value;
                    },
                    breaks: true
                });
                
                // Convert markdown to HTML and insert into the page
                document.getElementById('markdown-content').innerHTML = marked.parse(markdownContent);
                
                // Initialize syntax highlighting for code blocks
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightBlock(block);
                });
                
                // Render MathJax equations
                if (typeof MathJax !== 'undefined') {
                    MathJax.typesetPromise().catch((err) => {
                        console.error('Error rendering MathJax:', err);
                    });
                }
                
            } catch (error) {
                console.error('Error loading paper review:', error);
                document.getElementById('markdown-content').innerHTML = `
                    <div class="error">
                        <h2>Error Loading Paper Review</h2>
                        <p>${error.message}</p>
                        <p>Please check the paper ID and try again.</p>
                    </div>
                `;
            }
        });
    </script>
</body>
</html> 